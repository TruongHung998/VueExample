"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports[Symbol.toStringTag]="Module";var e=require("vue");const t="Disqus shortname is required. (To resolve this, go to: https://ktquez.github.io/vue-disqus/setup.html#installation)",n=["api_key","author_s3","category_id","identifier","integration","language","remote_auth_s3","slug","title","url"],o=["name","button","icon","url","logout","width","height"],i=["afterRender","onInit","onIdentify","beforeComment","onNewComment","onPaginate","onReady","preData","preInit","preReset"],r=Symbol("disqus"),s=e=>requestAnimationFrame((()=>requestAnimationFrame(e)));var a=e.defineComponent({name:"Disqus",props:{shortname:String,pageConfig:{type:Object,validator:e=>Object.keys(e).every((e=>n.includes(e)))},ssoConfig:{type:Object,validator:e=>Object.keys(e).every((e=>o.includes(e)))},lang:{type:String,default:"en"},lazy:{type:Boolean,default:!0},lazyConfig:{type:Object,default:()=>({root:null,rootMargin:"300px",threshold:.5})}},setup(n,{emit:o}){const s=e.inject(r),a=e.getCurrentInstance(),u=e.ref(null),c=e.ref(window.location.pathname),l=e.computed((()=>{const e=n.shortname||s.shortname;if(!e)throw new Error(t);return e}));function d(){if(s&&(s.reset=p),window.DISQUS)return p();window.disqus_config=function(){f(this)},function(){const e=+new Date,t=document,n=t.createElement("script");n.setAttribute("id","embed-disqus"),n.setAttribute("data-timestamp",e.toString()),n.type="text/javascript",n.async=!0,n.src=`//${l.value}.disqus.com/embed.js`,(t.head||t.body).appendChild(n)}(),e.watch((()=>c.value),p)}function p(){window.DISQUS.reset({reload:!0,config:function(){f(this)}})}function g(e){e.forEach((e=>{var t;e.isIntersecting&&(null==(t=u.value)||t.disconnect(),d())}))}function f(e){!function(e){const t={url:document.baseURI,identifier:window.location.pathname};Object.assign(e.page,t),n.pageConfig&&Object.keys(n.pageConfig).length&&Object.assign(e.page,n.pageConfig)}(e),function(e){i.forEach((t=>{e.callbacks[t]=[e=>{o(t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().replace("on-",""),e)}]}))}(e),n.ssoConfig&&Object.keys(n.ssoConfig).length&&Object.assign(e.sso,n.ssoConfig),e.language=n.lang}e.watch((()=>n.lang),p),e.onMounted((()=>{if(n.lazy)return function(){var e;if("IntersectionObserver"in window)return u.value=new IntersectionObserver(g,n.lazyConfig),u.value.observe(null==(e=null==a?void 0:a.proxy)?void 0:e.$el);d()}();d()}))}});const u={id:"disqus_thread",style:{"min-height":"200px"}};a.render=function(t,n){return e.openBlock(),e.createBlock("div",u)};var c=e.defineComponent({name:"DisqusCount",props:{url:String,shortname:String,identifier:{type:String,required:!0},tag:{type:String,default:"span"}},setup(n){const o=e.inject(r),i=e.ref(window.location.pathname),a=e.computed((()=>"a"===n.tag?`${n.url}#disqus_thread`:"#")),u=e.computed((()=>"span"===n.tag?n.url:null)),c=e.computed((()=>{const e=n.shortname||o?o.shortname:null;if(!e)throw new Error(t);return e})),l={href:a.value,"data-disqus-url":u.value,"data-disqus-identifier":n.identifier};function d(){window.DISQUSWIDGETS.getCount({reset:!0})}return e.onMounted((function(){if("DISQUSWIDGETS"in window)return s((()=>d()));(function(){if(document.getElementById("dsq-count-scr"))return;const e=document,t=e.createElement("script");t.async=!0,t.id="dsq-count-scr",t.src=`//${c.value}.disqus.com/count.js`,(e.head||e.body).appendChild(t)})(),e.watch((()=>i.value),(()=>s((()=>d()))))})),{disqusAttrs:l}}});c.render=function(t,n){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.tag),e.mergeProps({class:"disqus-comment-count"},t.disqusAttrs),null,16)},exports.Disqus=a,exports.DisqusCount=c,exports.default=function(e,t={}){e.component("Disqus",a),e.component("DisqusCount",c);const n={shortname:t.shortname,reset:null};e.provide(r,n)};
